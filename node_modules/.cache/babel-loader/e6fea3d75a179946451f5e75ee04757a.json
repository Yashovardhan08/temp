{"ast":null,"code":"/** PURE_IMPORTS_START tslib,_innerSubscribe PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { SimpleOuterSubscriber, innerSubscribe, SimpleInnerSubscriber } from '../innerSubscribe';\nexport function audit(durationSelector) {\n  return function auditOperatorFunction(source) {\n    return source.lift(new AuditOperator(durationSelector));\n  };\n}\nvar AuditOperator = /*@__PURE__*/function () {\n  function AuditOperator(durationSelector) {\n    this.durationSelector = durationSelector;\n  }\n  AuditOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new AuditSubscriber(subscriber, this.durationSelector));\n  };\n  return AuditOperator;\n}();\nvar AuditSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(AuditSubscriber, _super);\n  function AuditSubscriber(destination, durationSelector) {\n    var _this = _super.call(this, destination) || this;\n    _this.durationSelector = durationSelector;\n    _this.hasValue = false;\n    return _this;\n  }\n  AuditSubscriber.prototype._next = function (value) {\n    this.value = value;\n    this.hasValue = true;\n    if (!this.throttled) {\n      var duration = void 0;\n      try {\n        var durationSelector = this.durationSelector;\n        duration = durationSelector(value);\n      } catch (err) {\n        return this.destination.error(err);\n      }\n      var innerSubscription = innerSubscribe(duration, new SimpleInnerSubscriber(this));\n      if (!innerSubscription || innerSubscription.closed) {\n        this.clearThrottle();\n      } else {\n        this.add(this.throttled = innerSubscription);\n      }\n    }\n  };\n  AuditSubscriber.prototype.clearThrottle = function () {\n    var _a = this,\n      value = _a.value,\n      hasValue = _a.hasValue,\n      throttled = _a.throttled;\n    if (throttled) {\n      this.remove(throttled);\n      this.throttled = undefined;\n      throttled.unsubscribe();\n    }\n    if (hasValue) {\n      this.value = undefined;\n      this.hasValue = false;\n      this.destination.next(value);\n    }\n  };\n  AuditSubscriber.prototype.notifyNext = function () {\n    this.clearThrottle();\n  };\n  AuditSubscriber.prototype.notifyComplete = function () {\n    this.clearThrottle();\n  };\n  return AuditSubscriber;\n}(SimpleOuterSubscriber);","map":{"version":3,"mappings":";AAKA,OAAO,KAAEA,oBAAuB;AAgDhC,SAAMC,qBAAmB,gBAA0D;OACjF,SAAOC,KAAS;SACd,SAAOC,qBAAgB,OAAc;IACrC;EACH;AAED;IACEC,6BAAoB,YAA0D;WAA1DA;IACnB;EAED;eACS,UAAO,KAAU,aAAIC,UAAsB,QAAU,EAAE;IAC/D;EACH;EAPA,OAOCD;AAOD;IAAoCE,yCAA2BC;EAM7DP,iCAAY,QACQ;WADpBM,eAEE,YAAM,kBAAY,EACnB;IAFmB,uBAAgB,KAAhB,aAAgB,CAA0C;IAJtEE,sBAAyB,GAACC;;IAMjC;EAES;iBACE,UAAS;IACnB,IAAI,CAACC,QAAQA,KAAG;IAChB,IAAI,CAACC,QAAK,OAAS;QACjB,KAAI,UAAQ;MACZ,IAAIC;UACM;QACR,oBAAW,OAAgB,CAACH,gBAAO;QACpCG;MAAC,SACAC,KAAO;QACR;MACD;MACA,IAAIC,iBAAC,GAAiBC,cAAI,SAAkB,MAAQC;UAClD,kBAAkB,IAAGF;QACtB;aACC;QACD;MACF;IACF;EAED;iBACQ,UAAE,cAAO;IACf,IAAIG,SAAS;MAAEP;MAAAC;MAAAO;QACbA,SAAK,EAAM;MACX,IAAI,CAACC,gBAAY;MACjB,cAAU,YAAc;MACzBD;IACD;QACEP,QAAK,EAAK;MACV,IAAI,CAACD,QAAQU,SAAS;MACtB,IAAI,CAACT,WAAW,KAAM;MACvB;IACF;EAED;iBACO,UAAgB;IACtB;EAED;iBACO,UAAgB;IACtB;EACH;EApDoC,sBAoDnC","names":["tslib_1","SimpleOuterSubscriber","audit","auditOperatorFunction","AuditOperator","subscriber","AuditSubscriber","_super","_this","durationSelector","value","hasValue","duration","err","innerSubscription","innerSubscribe","SimpleInnerSubscriber","_a","throttled","remove","undefined"],"sources":["../../../src/internal/operators/audit.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}