{"ast":null,"code":"/** PURE_IMPORTS_START _Observable,_util_identity,_util_isScheduler PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { identity } from '../util/identity';\nimport { isScheduler } from '../util/isScheduler';\nexport function generate(initialStateOrOptions, condition, iterate, resultSelectorOrObservable, scheduler) {\n  var resultSelector;\n  var initialState;\n  if (arguments.length == 1) {\n    var options = initialStateOrOptions;\n    initialState = options.initialState;\n    condition = options.condition;\n    iterate = options.iterate;\n    resultSelector = options.resultSelector || identity;\n    scheduler = options.scheduler;\n  } else if (resultSelectorOrObservable === undefined || isScheduler(resultSelectorOrObservable)) {\n    initialState = initialStateOrOptions;\n    resultSelector = identity;\n    scheduler = resultSelectorOrObservable;\n  } else {\n    initialState = initialStateOrOptions;\n    resultSelector = resultSelectorOrObservable;\n  }\n  return new Observable(function (subscriber) {\n    var state = initialState;\n    if (scheduler) {\n      return scheduler.schedule(dispatch, 0, {\n        subscriber: subscriber,\n        iterate: iterate,\n        condition: condition,\n        resultSelector: resultSelector,\n        state: state\n      });\n    }\n    do {\n      if (condition) {\n        var conditionResult = void 0;\n        try {\n          conditionResult = condition(state);\n        } catch (err) {\n          subscriber.error(err);\n          return undefined;\n        }\n        if (!conditionResult) {\n          subscriber.complete();\n          break;\n        }\n      }\n      var value = void 0;\n      try {\n        value = resultSelector(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n      subscriber.next(value);\n      if (subscriber.closed) {\n        break;\n      }\n      try {\n        state = iterate(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n    } while (true);\n    return undefined;\n  });\n}\nfunction dispatch(state) {\n  var subscriber = state.subscriber,\n    condition = state.condition;\n  if (subscriber.closed) {\n    return undefined;\n  }\n  if (state.needIterate) {\n    try {\n      state.state = state.iterate(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n  } else {\n    state.needIterate = true;\n  }\n  if (condition) {\n    var conditionResult = void 0;\n    try {\n      conditionResult = condition(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n    if (!conditionResult) {\n      subscriber.complete();\n      return undefined;\n    }\n    if (subscriber.closed) {\n      return undefined;\n    }\n  }\n  var value;\n  try {\n    value = state.resultSelector(state.state);\n  } catch (err) {\n    subscriber.error(err);\n    return undefined;\n  }\n  if (subscriber.closed) {\n    return undefined;\n  }\n  subscriber.next(value);\n  if (subscriber.closed) {\n    return undefined;\n  }\n  return this.schedule(state);\n}","map":{"version":3,"mappings":"AAAA;AAEA,SAASA,UAAU,QAAM;AAEzB,SAASC,gBAAa,kBAAM;AA8P5B,SAAMC,WAAU,QAAe,qBACA;OAK7B,SAAIC,QAAiC;EACrC,IAAIC,cAAgB;EAEpB,IAAIC,YAAU;MACZC,SAAM,OAAU;IAChB,cAAYC,qBAAuB;IACnCF,YAAY,UAAQ,aAAU;IAC9BG,SAAO,GAAGC,OAAQ,UAAQ;IAC1BC,iBAAiB,QAAQ;IACzBN,cAAY,UAAQ,eAAU;IAC/BO;SACC,8BAAe,KAA0BC,SAAC;IAC1CP,eAAcE,qBAAgC;IAC9CH,cAAY;IACbO;SACC;IACAN,eAAcE,qBAAG;IAClBH;EAED;SACE,IAAIJ,UAAQ,WAAaa;IACzB,IAAIC,oBAAW;QACbH,SAAO;aACLA,SAAU;QACVE,UAAO;QACPH,SAASA;QACTF,oBAAc;QACdJ,cAAK;QACJU;MACJ;IAED;;UAEIN,SAAI;QACJ,IAAIO;YACF;UACDA;QAAC,SACAC;UACAH,UAAO,MAAS,CAACG;UAClB;QACD;YACE,gBAAW;UACXH,UAAM;UACP;QACF;MACD;MACA,IAAII;UACF;QACDA;MAAC,SACAD;QACAH,UAAO,MAAS,CAACG;QAClB;MACD;MACAH,UAAI,KAAW,MAAM;UACnBA,UAAM;QACP;MACD;UACE;QACDC;MAAC,SACAE;QACAH,UAAO,MAAS,CAACG;QAClB;MACF;IAED,SAAO;IACN;EACJ;AAED;SACUE;EACR,IAAIL,UAAU,GAACC,KAAM,CAAED;IAAAL;MACrBK,UAAO,OAAU;IAClB;EACD;MACEC,KAAI;QACF;MACDA;IAAC,SACAE;MACAH,UAAO,MAAS,CAACG;MAClB;IACF;SACC;IACDF;EACD;MACEN,SAAI;IACJ,IAAIO;QACF;MACDA;IAAC,SACAC;MACAH,UAAO,MAAS,CAACG;MAClB;IACD;QACE,gBAAW;MACXH,UAAO,SAAU;MAClB;IACD;QACEA,UAAO,OAAU;MAClB;IACF;EACD;EACA,IAAII;MACF;IACDA;EAAC,SACAD;IACAH,UAAO,MAAS,CAACG;IAClB;EACD;MACEH,UAAO,OAAU;IAClB;EACD;EACAA,UAAI,KAAW,MAAM;MACnBA,UAAO,OAAU;IAClB;EACD;EACD","names":["Observable","identity","isScheduler","generate","resultSelector","initialState","arguments","initialStateOrOptions","condition","options","iterate","scheduler","undefined","subscriber","state","conditionResult","err","value","dispatch"],"sources":["../../../src/internal/observable/generate.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}