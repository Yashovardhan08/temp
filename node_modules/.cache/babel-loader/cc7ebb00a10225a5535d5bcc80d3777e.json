{"ast":null,"code":"/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function bufferCount(bufferSize, startBufferEvery) {\n  if (startBufferEvery === void 0) {\n    startBufferEvery = null;\n  }\n  return function bufferCountOperatorFunction(source) {\n    return source.lift(new BufferCountOperator(bufferSize, startBufferEvery));\n  };\n}\nvar BufferCountOperator = /*@__PURE__*/function () {\n  function BufferCountOperator(bufferSize, startBufferEvery) {\n    this.bufferSize = bufferSize;\n    this.startBufferEvery = startBufferEvery;\n    if (!startBufferEvery || bufferSize === startBufferEvery) {\n      this.subscriberClass = BufferCountSubscriber;\n    } else {\n      this.subscriberClass = BufferSkipCountSubscriber;\n    }\n  }\n  BufferCountOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new this.subscriberClass(subscriber, this.bufferSize, this.startBufferEvery));\n  };\n  return BufferCountOperator;\n}();\nvar BufferCountSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(BufferCountSubscriber, _super);\n  function BufferCountSubscriber(destination, bufferSize) {\n    var _this = _super.call(this, destination) || this;\n    _this.bufferSize = bufferSize;\n    _this.buffer = [];\n    return _this;\n  }\n  BufferCountSubscriber.prototype._next = function (value) {\n    var buffer = this.buffer;\n    buffer.push(value);\n    if (buffer.length == this.bufferSize) {\n      this.destination.next(buffer);\n      this.buffer = [];\n    }\n  };\n  BufferCountSubscriber.prototype._complete = function () {\n    var buffer = this.buffer;\n    if (buffer.length > 0) {\n      this.destination.next(buffer);\n    }\n    _super.prototype._complete.call(this);\n  };\n  return BufferCountSubscriber;\n}(Subscriber);\nvar BufferSkipCountSubscriber = /*@__PURE__*/function (_super) {\n  tslib_1.__extends(BufferSkipCountSubscriber, _super);\n  function BufferSkipCountSubscriber(destination, bufferSize, startBufferEvery) {\n    var _this = _super.call(this, destination) || this;\n    _this.bufferSize = bufferSize;\n    _this.startBufferEvery = startBufferEvery;\n    _this.buffers = [];\n    _this.count = 0;\n    return _this;\n  }\n  BufferSkipCountSubscriber.prototype._next = function (value) {\n    var _a = this,\n      bufferSize = _a.bufferSize,\n      startBufferEvery = _a.startBufferEvery,\n      buffers = _a.buffers,\n      count = _a.count;\n    this.count++;\n    if (count % startBufferEvery === 0) {\n      buffers.push([]);\n    }\n    for (var i = buffers.length; i--;) {\n      var buffer = buffers[i];\n      buffer.push(value);\n      if (buffer.length === bufferSize) {\n        buffers.splice(i, 1);\n        this.destination.next(buffer);\n      }\n    }\n  };\n  BufferSkipCountSubscriber.prototype._complete = function () {\n    var _a = this,\n      buffers = _a.buffers,\n      destination = _a.destination;\n    while (buffers.length > 0) {\n      var buffer = buffers.shift();\n      if (buffer.length > 0) {\n        destination.next(buffer);\n      }\n    }\n    _super.prototype._complete.call(this);\n  };\n  return BufferSkipCountSubscriber;\n}(Subscriber);","map":{"version":3,"mappings":";AACA,OAAO,KAAEA,OAAU,MAAE,OAAM;AA2D3B,SAAMC,UAAU,QAAW,eAAwB;OAAA;EACjD,oBAAgB;IACdC,gBAAc,GAAK,IAAI;EACzB;EACD;IAED;EAGE;;uBAAgD,4BAAwB;WACjEC,mBAAgB,CAAIC,UAAU,kBAAK;QACtC,WAAK,aAAkB;QACxB;SAAMF;MACL,IAAI,CAACG,eAAe,GAAGC;KACxB,MACF;MAED,gDAAK;IACH;EACF;EACFH,6BAAC;IAAA;EAOD;EAAuC;GAGrC;yBACE,gBAAM,UAAYI,MACnB;SAFiD,gCAAkB;WAF5DD,qBAAiB;;IAIxBE;IAESA;IACR,OAAMA,KAAM;;uBAIK,UAAS,SAAU,UAAEC;QACpCC,MAAK,cAAY;UACjB,KAAK,MAAM,CAAG;QACfA;MACF;MAES;IACR;;uBAEO,UAAiB,UAAQ;QAC/BA;IACD,iBAAM;MACP;IACH;IAzBuCH,MAAU,CAyBhDI;EAOD;EAA2C;YAIzC;6BACE,gBAAM,UAAYJ,MACnB;SAFiD,oCAAkB;WAAUK,qCAAwB;IAH9F,kBAAwB,CAACC;IACzBL,gBAAkB;;IAIzBA;IAESA;IACF;;2BAGM,UAAgB,MAAQ;QAClCM,SAAQ;MAAAV,UAAS;MAAAF;MAAAa;MAAAC;QAClB;IAED,SAAS,GAACd,gBAAiB,KAAK,GAAI;MAClCa,OAAM,KAAM,CAAG;;SAEf,IAAIE,WAAO,CAAMC,MAAK;UACpBR,SAAQK,OAAQ,EAAE,CAAC;YACnB,KAAK;UACNL;QACFK;QACF;MAES;IACF;;2BAGS,UAAa,CAAEI,SAAC;QAC7BL,KAAI;MAAOC,OAAM,GAAID,EAAE;MAAAM;kBACrB,OAAY,GAAI,CAAC;UAClBV;MACF;QACDU,WAAM,YAAS;MAChB;IAEH;IAtC2Cb,MAAU,CAsCpDI","names":["tslib_1","Subscriber","startBufferEvery","BufferCountOperator","bufferSize","subscriberClass","BufferCountSubscriber","_super","_this","value","buffer","prototype","BufferSkipCountSubscriber","call","_a","buffers","count","i","length","_complete","destination"],"sources":["../../../src/internal/operators/bufferCount.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}