{"ast":null,"code":"\"use strict\";\n\n// Copyright (c) 2018-2020 WalletLink.org <https://www.walletlink.org/>\n// Copyright (c) 2018-2020 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Session = void 0;\nconst crypto_1 = __importDefault(require(\"crypto\"));\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nconst STORAGE_KEY_SESSION_ID = \"session:id\";\nconst STORAGE_KEY_SESSION_SECRET = \"session:secret\";\nconst STORAGE_KEY_SESSION_LINKED = \"session:linked\";\nclass Session {\n  constructor(storage, id, secret, linked) {\n    this._storage = storage;\n    this._id = id || crypto_1.default.randomBytes(16).toString(\"hex\");\n    this._secret = secret || crypto_1.default.randomBytes(32).toString(\"hex\");\n    this._key = crypto_1.default.createHash(\"sha256\").update(`${this._id}, ${this._secret} WalletLink`, \"ascii\").digest(\"hex\");\n    this._linked = !!linked;\n  }\n  static load(storage) {\n    const id = storage.getItem(STORAGE_KEY_SESSION_ID);\n    const linked = storage.getItem(STORAGE_KEY_SESSION_LINKED);\n    const secret = storage.getItem(STORAGE_KEY_SESSION_SECRET);\n    if (id && secret) {\n      return new Session(storage, id, secret, linked === \"1\");\n    }\n    return null;\n  }\n  static clear(storage) {\n    storage.removeItem(STORAGE_KEY_SESSION_SECRET);\n    storage.removeItem(STORAGE_KEY_SESSION_ID);\n    storage.removeItem(STORAGE_KEY_SESSION_LINKED);\n  }\n  static get persistedSessionIdChange$() {\n    return rxjs_1.fromEvent(window, \"storage\").pipe(operators_1.filter(evt => evt.key === STORAGE_KEY_SESSION_ID), operators_1.map(evt => ({\n      oldValue: evt.oldValue || null,\n      newValue: evt.newValue || null\n    })));\n  }\n  get id() {\n    return this._id;\n  }\n  get secret() {\n    return this._secret;\n  }\n  get key() {\n    return this._key;\n  }\n  get linked() {\n    return this._linked;\n  }\n  set linked(val) {\n    this._linked = val;\n    this.persistLinked();\n  }\n  save() {\n    this._storage.setItem(STORAGE_KEY_SESSION_ID, this._id);\n    this._storage.setItem(STORAGE_KEY_SESSION_SECRET, this._secret);\n    this.persistLinked();\n    return this;\n  }\n  persistLinked() {\n    this._storage.setItem(STORAGE_KEY_SESSION_LINKED, this._linked ? \"1\" : \"0\");\n  }\n}\nexports.Session = Session;","map":{"version":3,"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","Session","crypto_1","require","rxjs_1","operators_1","STORAGE_KEY_SESSION_ID","STORAGE_KEY_SESSION_SECRET","STORAGE_KEY_SESSION_LINKED","constructor","storage","id","secret","linked","_storage","_id","default","randomBytes","toString","_secret","_key","createHash","update","digest","_linked","load","getItem","clear","removeItem","persistedSessionIdChange$","fromEvent","window","pipe","filter","evt","key","map","oldValue","newValue","val","persistLinked","save","setItem"],"sources":["/Users/radioactivedevil08/Polygon/starter-kits/node_modules/walletlink/dist/relay/Session.js"],"sourcesContent":["\"use strict\";\n// Copyright (c) 2018-2020 WalletLink.org <https://www.walletlink.org/>\n// Copyright (c) 2018-2020 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Session = void 0;\nconst crypto_1 = __importDefault(require(\"crypto\"));\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nconst STORAGE_KEY_SESSION_ID = \"session:id\";\nconst STORAGE_KEY_SESSION_SECRET = \"session:secret\";\nconst STORAGE_KEY_SESSION_LINKED = \"session:linked\";\nclass Session {\n    constructor(storage, id, secret, linked) {\n        this._storage = storage;\n        this._id = id || crypto_1.default.randomBytes(16).toString(\"hex\");\n        this._secret = secret || crypto_1.default.randomBytes(32).toString(\"hex\");\n        this._key = crypto_1.default\n            .createHash(\"sha256\")\n            .update(`${this._id}, ${this._secret} WalletLink`, \"ascii\")\n            .digest(\"hex\");\n        this._linked = !!linked;\n    }\n    static load(storage) {\n        const id = storage.getItem(STORAGE_KEY_SESSION_ID);\n        const linked = storage.getItem(STORAGE_KEY_SESSION_LINKED);\n        const secret = storage.getItem(STORAGE_KEY_SESSION_SECRET);\n        if (id && secret) {\n            return new Session(storage, id, secret, linked === \"1\");\n        }\n        return null;\n    }\n    static clear(storage) {\n        storage.removeItem(STORAGE_KEY_SESSION_SECRET);\n        storage.removeItem(STORAGE_KEY_SESSION_ID);\n        storage.removeItem(STORAGE_KEY_SESSION_LINKED);\n    }\n    static get persistedSessionIdChange$() {\n        return rxjs_1.fromEvent(window, \"storage\").pipe(operators_1.filter(evt => evt.key === STORAGE_KEY_SESSION_ID), operators_1.map(evt => ({\n            oldValue: evt.oldValue || null,\n            newValue: evt.newValue || null\n        })));\n    }\n    get id() {\n        return this._id;\n    }\n    get secret() {\n        return this._secret;\n    }\n    get key() {\n        return this._key;\n    }\n    get linked() {\n        return this._linked;\n    }\n    set linked(val) {\n        this._linked = val;\n        this.persistLinked();\n    }\n    save() {\n        this._storage.setItem(STORAGE_KEY_SESSION_ID, this._id);\n        this._storage.setItem(STORAGE_KEY_SESSION_SECRET, this._secret);\n        this.persistLinked();\n        return this;\n    }\n    persistLinked() {\n        this._storage.setItem(STORAGE_KEY_SESSION_LINKED, this._linked ? \"1\" : \"0\");\n    }\n}\nexports.Session = Session;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}